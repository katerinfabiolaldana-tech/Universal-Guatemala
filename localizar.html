<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Localizar una Universal | Guatemala</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #fbfbfb;
}

/* HEADER */
header {
    background: linear-gradient(135deg, #02164b, #ffffff, #750707);
    background-size: 300% 300%;
    animation: fondo 6s ease infinite;
    padding: 4px 20px;
    display: flex;
    justify-content: center;
}

@keyframes fondo {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}


.logo {
    width: 240px;
}

/* TITULO */
.titulo {
    text-align: center;
    padding: 30px 15px;
}

.titulo h1 {
    margin-bottom: 8px;
}

/* BUSCADOR */
.buscador {
    max-width: 600px;
    margin: auto;
    padding: 0 15px 30px;
}

.buscador input {
    width: 100%;
    padding: 14px;
    border-radius: 999px;
    border: 1px solid #ccc;
    font-size: 16px;
}

/* GRID TARJETAS */
.locales-grid {
    max-width: 1200px;
    margin: auto;
    padding: 0 15px 60px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 25px;
}

.iglesia-card {
    background: #fff;
    border-radius: 14px;
    padding: 14px;
    box-shadow: 0 3px 10px rgba(0,0,0,.12);
    cursor: pointer;
    transition: transform .2s;
    text-align: center;
}

.iglesia-card:hover {
    transform: translateY(-5px);
}

.iglesia-card img {
    width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 12px;
}

.iglesia-card h3 {
    margin: 10px 0 5px;
}

/* MODAL */
.modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.6);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

.modal-contenido {
    background: #f5f7fb;
    width: 95%;
    max-width: 1100px;
    border-radius: 18px;
    padding: 20px;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
}

.cerrar {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 28px;
    cursor: pointer;
}

/* GRID MODAL */
.modal-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;
}

.modal-imagen img {
    width: 100%;
    border-radius: 16px;
}

.btn-copy {
    background: #e0e6ef;
    border: none;
    padding: 10px 16px;
    border-radius: 999px;
    cursor: pointer;
    margin: 10px 0;
}

.acciones {
    display: flex;
    gap: 15px;
    margin-top: 20px;
}

.acciones a {
    flex: 1;
    background: #fff;
    padding: 14px;
    border-radius: 16px;
    text-align: center;
    text-decoration: none;
    font-weight: bold;
    color: #22386d;
}

/* HORARIOS */
.horarios {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 15px;
    margin-top: 20px;
}

.dia {
    background: #fff;
    border-radius: 16px;
    padding: 15px;
    text-align: center;
}

.dia.activo {
    background: linear-gradient(180deg, #22386d, #0b4fa3);
    color: #fff;
}
.hora-proxima {
    background: #ffffff;
    color: #000;
    padding: 2px 8px;
    border-radius: 8px;
    display: inline-block;
    font-weight: bold;
    margin-top: 6px;
}


/* RESPONSIVE */
@media (max-width: 768px) {
    .modal-grid {
        grid-template-columns: 1fr;
    }
}
</style>
</head>

<body>

<header>
    <img src="imagenes/logo.png" class="logo">
</header>

<div class="titulo">
    <h1>Encuentra una Universal cerca de ti</h1>
    <p>Busca por zona, municipio o departamento</p>
</div>

<div class="buscador">
    <input type="text" id="busqueda" placeholder="Ejemplo: Zona 7, Xela...">
</div>

<div class="locales-grid" id="contenedor-iglesias"></div>

<!-- MODAL -->
<div class="modal" id="modalIglesia">
    <div class="modal-contenido">
        <span class="cerrar" onclick="cerrarModal()">×</span>

        <div class="modal-grid">
            <div class="modal-imagen">
                <img id="modalImg">
            </div>

            <div>
                <h2 id="modalNombre"></h2>
                <p id="modalDireccion"></p>
                <button class="btn-copy" onclick="copiarDireccion()">Copiar dirección</button>
                <p id="modalTelefono"></p>

                <div class="acciones">
                    <a id="btnRuta" target="_blank">Trazar ruta</a>
                    <a id="btnLlamar">Llamar</a>
                    <a href="#">Donar</a>
                </div>
            </div>
        </div>

        <h3>Horarios de reunión</h3>
        <div class="horarios" id="modalHorarios"></div>
    </div>
</div>

<script src="datos/iglesias.js"></script>

<script>
const contenedor = document.getElementById("contenedor-iglesias");
const modalIglesia = document.getElementById("modalIglesia");
const modalImg = document.getElementById("modalImg");
const modalNombre = document.getElementById("modalNombre");
const modalDireccion = document.getElementById("modalDireccion");
const modalTelefono = document.getElementById("modalTelefono");
const btnRuta = document.getElementById("btnRuta");
const btnLlamar = document.getElementById("btnLlamar");
const modalHorarios = document.getElementById("modalHorarios");

function render(lista) {
    contenedor.innerHTML = "";
    lista.forEach(i => {
        contenedor.innerHTML += `
            <div class="iglesia-card" onclick='abrirModal(${JSON.stringify(i)})'>
                <img src="${i.imagen}">
                <h3>${i.nombre}</h3>
                <p>${i.direccion}</p>
            </div>
        `;
    });
}

render(iglesias);

document.getElementById("busqueda").addEventListener("input", e => {
    const t = e.target.value.toLowerCase();
    render(iglesias.filter(i =>
        i.nombre.toLowerCase().includes(t) ||
        i.direccion.toLowerCase().includes(t)
    ));
});

function abrirModal(i) {
    modalIglesia.style.display = "flex";
    modalImg.src = i.imagen;
    modalNombre.textContent = i.nombre;
    modalDireccion.textContent = i.direccion;
    modalTelefono.textContent = i.telefono;
    btnRuta.href = `https://waze.com/ul?ll=${i.lat},${i.lng}&navigate=yes`;
    btnLlamar.href = `tel:${i.telefono.replace(/\D/g,'')}`;
    renderHorarios(i.horarios);
}

function renderHorarios(h) {
    modalHorarios.innerHTML = "";

    const ahora = new Date();
    const hoy = ahora.getDay();
    const horaActual = ahora.getHours() * 60 + ahora.getMinutes();

    const dias = [
        { nombre: "Domingo", key: "domingo", index: 0 },
        { nombre: "Lunes", key: "lunes", index: 1 },
        { nombre: "Martes", key: "martes", index: 2 },
        { nombre: "Miércoles", key: "miercoles", index: 3 },
        { nombre: "Jueves", key: "jueves", index: 4 },
        { nombre: "Viernes", key: "viernes", index: 5 },
        { nombre: "Sábado", key: "sabado", index: 6 }
    ];

    dias.forEach(d => {
        if (!h[d.key]) return;

        const activo = hoy === d.index ? "activo" : "";
        let contenidoHoras = "";

        h[d.key].forEach(hora => {
            let clase = "";

            if (hoy === d.index) {
                const [tiempo, periodo] = hora.split(" ");
                let [h, m] = tiempo.split(":").map(Number);

                if (periodo === "pm" && h !== 12) h += 12;
                if (periodo === "am" && h === 12) h = 0;

                const minutosHora = h * 60 + m;

                if (minutosHora > horaActual && !contenidoHoras.includes("hora-proxima")) {
                    clase = "hora-proxima";
                }
            }

            contenidoHoras += `<div class="${clase}">${hora}</div>`;
        });

        modalHorarios.innerHTML += `
            <div class="dia ${activo}">
                <strong>${d.nombre}</strong>
                ${contenidoHoras}
            </div>
        `;
    });
}


function cerrarModal() {
    modalIglesia.style.display = "none";
}

function copiarDireccion() {
    navigator.clipboard.writeText(modalDireccion.textContent);
}
</script>

</body>
</html>
